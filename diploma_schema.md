# Схема диплома: Классификация болезней томатов с использованием машинного обучения

## 1. Введение (3-4 страницы)
### 1.1 Актуальность исследования
- Необходимость автоматизации диагностики болезней сельскохозяйственных культур
- Потенциал применения компьютерного зрения и машинного обучения в сельском хозяйстве

## 2. Теоретическая часть (10-15 страниц)
### 2.1 Обзор методов классификации изображений
- Традиционные методы машинного обучения
  - Метод опорных векторов (SVM)
  - Особенности применения SVM для классификации изображений
- Сверточные нейронные сети
- Методы обработки изображений
  - Resize
  - Flatten
  - Нормализация

### 2.2 Болезни томатов
- Типы заболеваний растений
  - Бактериальные поражения
  - Вирусные заболевания
  - Грибковые инфекции
- Визуальная диагностика болезней
  - Характерные признаки поражений
  - Влияние болезней на структуру листа
- Экономический ущерб от поражений растений

## 3. Практическая реализация (15-20 страниц)
### 3.1 Архитектура системы
- Сбор и подготовка данных
  - Источники датасета
    - Plant Village Dataset
    - Характеристики изображений:
      * Разрешение: 256x256 пикселей
      * Глубина цвета: 8 бит
      * Формат: JPEG
      * Цветовой профиль: RGB

- Предобработка изображений
  - Удаление фонового шума
    * Критерий фоновых пикселей: интенсивность менее 10
    * Цель: устранение искажающих статистических признаков
  - Фильтрация изображений
    * Критерии отбора здоровых листьев:
      - Стандартное отклонение > 30
      - Показатель однородности (HOM) > 0.4
  - Resize (64x64 пикселя)
  - Flatten
  - Стандартизация (StandardScaler)

- Источники признаков
  - RED канал RGB изображения
    * Связь с поглощением хлорофилла
    * Индикатор изменений при заболевании
  - NDVI_G (модифицированный вегетационный индекс)
    * Формула: (GREEN - RED) / (GREEN + RED)
    * Альтернатива классическому NDVI для RGB

- Извлечение признаков
  - Группы признаков:
    * STAT: статистические характеристики
    * HIST: квантованная гистограмма
    * GLCM: текстурные признаки
  - Способы извлечения:
    * Глобальные: над всем изображением
    * Локальные: с маской 17x17 пикселей

### 3.2 Технологический стек
- Python
- OpenCV (обработка изображений)
  - Resize
  - Чтение и преобразование изображений
- Scikit-learn (машинное обучение)
  - SVM
  - Стандартизация данных
  - Метрики качества
- Gradio (веб-интерфейс)
- FastAPI (серверное приложение)
- Hugging Face (развертывание модели)

### 3.3 Инструменты разработки
- Системы логирования
- Инструменты отладки
- Управление зависимостями
- Контейнеризация (Dockerfile)

## 4. Методология исследования (5-7 страниц)
### 4.1 Алгоритм обучения модели
1. **Подготовка датасета**
   - Распаковка архива с изображениями
   - Проверка целостности данных
   - Подсчет общего количества изображений

2. **Загрузка и предобработка изображений**
   - Чтение изображений из директорий классов
   - Resize до 64x64 пикселей
   - Преобразование в одномерный массив (flatten)
   - Ограничение количества изображений (до 500 на класс)

3. **Разделение данных**
   - Разбиение на обучающую и тестовую выборки
   - Соотношение: 80% обучение, 20% тестирование
   - Фиксированное случайное разделение (random_state=42)

4. **Масштабирование признаков**
   - Использование StandardScaler
   - Нормализация признаков
   - Центрирование данных относительно среднего

5. **Обучение классификатора**
   - Метод опорных векторов (SVM)
   - Параметры:
     * Ядро: радиальная базисная функция (RBF)
     * Включена вероятностная оценка
     * Балансировка классов

6. **Оценка качества модели**
   - Расчет метрик классификации
   - Построение матрицы ошибок
   - Визуализация результатов
   - Логирование отчета о классификации

7. **Сохранение модели**
   - Сохранение классификатора
   - Сохранение параметров масштабирования
   - Сохранение списка классов

### 4.2 Алгоритм предсказания
1. **Загрузка предобученной модели**
   - Проверка наличия сохраненной модели
   - Автоматическое обучение при отсутствии

2. **Предобработка изображения**
   - Resize до 64x64 пикселей
   - Преобразование в одномерный массив
   - Масштабирование с использованием сохраненного scaler

3. **Классификация**
   - Предсказание класса болезни
   - Расчет вероятностей для каждого класса
   - Выбор класса с максимальной вероятностью

4. **Представление результатов**
   - Вывод названия обнаруженной болезни
   - Отображение вероятностей для всех классов

## 5. Результаты исследования (5-7 страниц)
### 5.1 Характеристики модели
- Количество классов: 10
- Классы болезней:
  1. Бактериальное пятно
  2. Ранняя пятнистость
  3. Поздняя пятнистость
  4. Листовая плесень
  5. Пятнистость листьев Септориа
  6. Паутинный клещ
  7. Целевая пятнистость
  8. Вирус скручивания листьев
  9. Мозаичный вирус
  10. Здоровые растения

### 5.2 Метрики качества
- Точность классификации
- Полнота для каждого класса
- Визуализация матрицы ошибок

## 6. Практическая значимость (3-4 страницы)
- Автоматизация диагностики болезней томатов
- Возможность применения в сельском хозяйстве
- Потенциал масштабирования на другие культуры

## 7. Перспективы развития (3-4 страницы)
- Интеграция с мобильными приложениями
- Расширение числа классов болезней
- Улучшение точности классификации
- Создание облачного сервиса

## Приложения (5-10 страниц)
- Исходный код проекта
- Обучающая выборка
- Документация
- Руководство пользователя
